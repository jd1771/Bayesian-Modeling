---
title: "Bayesian modeling"
author: "Jas Dhaul"
date: "2023-06-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r data-load}
library(foreign)
df <- read.arff("nasa93.arff");

# Specify the variables we are interested in
variables_of_interest <- c("projectname", "cat2", "cplx", "year", "acap", "pcap", "act_effort");

# Create a new data frame with only the variables of interest
new_df <- subset(df, select = variables_of_interest);
```

``` {r get-data-info}
# Lets analyze the correlations between project complexity and the required effort
effort_by_complexity <- aggregate(act_effort ~ cplx, data = new_df, FUN = mean)
effort_by_complexity
```

``` {r convert-categorical-data}
# Define the categorical variables
categorical_vars <- c("cat2", "cplx", "acap", "pcap")

# Perform label encoding for each categorical variable
for (var in categorical_vars) {
  levels <- unique(new_df[[var]])  # Get unique levels of the variable
  new_df[[var]] <- as.integer(factor(new_df[[var]], levels = levels))  # Convert to numeric labels
}
new_df
```

``` {r create-model}
library(rstanarm);

# Specify the formula for the model
formula <- act_effort ~ cplx + year + cat2 + acap + pcap

# Fit the Bayesian model
model <- stan_glm(formula, data = new_df, family = gaussian(),
                  prior = normal(0, 10), chains = 4, iter = 2000)

# Print a summary of the model
summary(model)

```

